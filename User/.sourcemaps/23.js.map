{"version":3,"sources":["../../src/pages/card/card.module.ts","../../src/pages/card/card.ts"],"names":[],"mappings":"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","file":"23.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { CardPage } from './card';\r\n@NgModule({\r\n\tdeclarations: [\r\n\t\tCardPage\r\n\t],\r\n\timports: [\r\n\t\tIonicPageModule.forChild(CardPage),\r\n\t],\r\n\tentryComponents: [\r\n\t\tCardPage\r\n\t]\r\n})\r\nexport class CardPageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/card/card.module.ts","import { Component } from '@angular/core';\nimport {  NavParams, LoadingController, Loading,\n  AlertController, NavController, Platform  } from 'ionic-angular';\nimport { FormBuilder, Validators, FormGroup } from '@angular/forms';\nimport { ProfileProvider } from '../../providers/profile/profile';\nimport { IonicPage } from 'ionic-angular';\nimport { EventProvider } from '../../providers/event/event';\n// import { Injectable } from '@angular/core';\nimport { SettingsProvider } from '../../providers/settings/settings';\nimport { Http } from '@angular/http';\nimport { Stripe } from '@ionic-native/stripe';\nimport 'rxjs/add/operator/map';\nimport { LanguageProvider } from '../../providers/language/language';\n@IonicPage()\n/**\n * Generated class for the CardPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n\n@Component({\n  selector: 'page-card',\n  templateUrl: 'card.html',\n})\nexport class CardPage {\n  public cardpaymentForm: FormGroup;\n  loading: Loading;\n  public data: any;\n  info: any;\n  constructor(public prof: ProfileProvider, public stripe: Stripe, public lp: LanguageProvider, public settings: SettingsProvider, private http: Http, public eProvider: EventProvider, public platform: Platform, public nav: NavController, public navParams: NavParams,public loadingCtrl: LoadingController, \n    public alertCtrl: AlertController, \n    public formBuilder: FormBuilder) {\n\n      this.cardpaymentForm = formBuilder.group({\n        card: ['', Validators.compose([Validators.maxLength(16), Validators.minLength(16), Validators.required])],\n        cvc: ['', Validators.compose([Validators.maxLength(3), Validators.minLength(3), Validators.required])],\n        mm: ['', Validators.compose([Validators.maxLength(2), Validators.minLength(2), Validators.required])],\n        yy: ['', Validators.compose([Validators.maxLength(2), Validators.minLength(2), Validators.required])]\n      });\n  }\n\n\n  AddCard(): void {\n    this.RegisterCard(this.cardpaymentForm.value.card, this.cardpaymentForm.value.mm, \n      this.cardpaymentForm.value.yy, this.cardpaymentForm.value.cvc, 100, this.prof.user.email,\n      2)\n  }\n\n\n  RegisterCard(card, month, year, cvc, amount, email, driverPay){\n  \n    \n  this.platform.ready().then(() => {\n    // Now safe to use device APIs\n   (<any>window).window.PaystackPlugin.chargeCard(\n      (resp) => {\n       console.log(resp);\n       console.log(JSON.stringify(resp));\n    \n        this.eProvider.UpdateCard(card, month, year, cvc, amount, email, driverPay).then(success => {\n          this.prof.UpdatePaymentType(2).then(suc=>{\n          this.showPayMentAlert(this.lp.translate()[0].cardsuc, \"\", true);\n          })\n        }).catch(error =>{\n\n        })\n      //  });\n      },\n      (resp) => {\n        this.showPayMentAlert(this.lp.translate()[0].cardunc, \"\", false);\n      },\n      {\n        cardNumber: card, \n        expiryMonth: month, \n        expiryYear: year, \n        cvc: cvc,\n        email: email,\n        amountInKobo: amount,\n        transactionCharge : driverPay\n    });\n\n  })\n\n\n}\n\n\n\ngetInfo(ref) {\n  if (this.data) {\n    return Promise.resolve(this.data);\n  }\n\n  return new Promise(resolve => {\n    this.http.get('https://api.paystack.co/transaction/verify/' + ref )\n      .map(res => res.json())\n      .subscribe(data => {\n        this.data = data;\n        resolve(this.data);\n      });\n  });\n}\n\n\n  showPayMentAlert(title, subtitle, canLeave ){\n    let alert = this.alertCtrl.create({\n      title: title,\n      subTitle: subtitle,\n      buttons: [ {\n        text: this.lp.translate()[0].accept,\n        role: 'cancel',\n        handler: () => {\n         if (canLeave){\n          this.nav.popToRoot();\n         }\n        }\n      },],\n      enableBackdropDismiss: false \n    });\n    alert.present();\n  }\n\n\n  \n  // scanCard(){\n  //   console.log('scan clicked')\n  //   // alert('Coming Soon')\n  //   this.cardIO.canScan()\n  //   .then(\n  //     (res: boolean) => {\n  //       console.log(res)\n  //       //alert(res);\n  //       if(res){\n\n  //         let options = {\n  //           requireExpiry: true,\n  //           requireCVV: true,\n  //           useCardIOLogo: true,\n  //           supressManual: false,\n  //           requirePostalCode: false,\n  //           keepApplicationTheme:true,\n  //           suppressScan:true,\n  //           guideColor: '#3f84fc'\n  //         };\n\n  //         this.cardIO.scan(options).then(suc=>{\n  //           console.log(suc.cardNumber)\n  //         //  alert(suc);\n  //           this.eProvider.UpdateCard(suc.cardNumber, suc.expiryMonth, suc.expiryYear, suc.cvv, 100, this.prof.email, 20).then(success => {\n  //             this.prof.UpdatePaymentType(2).then(suc=>{\n  //             this.showPayMentAlert(this.lp.translate()[0].cardsuc, '', true)\n  //             })\n  //             }).catch(error =>{\n  //             //  alert(error);\n  //               this.showPayMentAlert(this.lp.translate()[0].cardunc, '', false)\n  //             })\n  //         });\n\n  //       }\n  //     }\n  //   );\n  //}\n\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/card/card.ts"],"sourceRoot":""}